Step 1: Load the `fees.json`, `merchant_data.json`, and `payments.csv` files into dataframes to prepare for linking merchants, transactions, and fee rules.
Step 2: Calculate the `intracountry` flag (True if `issuing_country` equals `acquirer_country`), determine the transaction month from `day_of_year`, and compute the total monthly volume and fraud rate (fraud amount / total amount) for each merchant; then, filter the data for Account Type 'F' and Card Scheme 'GlobalCard', merge the monthly stats, and aggregate the transactions by all fee-determining factors (merchant, aci, is_credit, intracountry, mcc, capture_delay, monthly stats) to prepare for fee rule matching.
Step 3: Create a Python script to load `payments.csv`, `merchant_data.json`, and `fees.json`, filter for transactions with `account_type` 'F' and `card_scheme` 'GlobalCard', calculate derived fields (intracountry, monthly merchant volume, and monthly merchant fraud rate), match each transaction to the applicable fee rule in `fees.json` (handling ranges and wildcards), calculate the fee for a 1234 EUR transaction for each matched rule, and print the average of these fees to 6 decimal places.
