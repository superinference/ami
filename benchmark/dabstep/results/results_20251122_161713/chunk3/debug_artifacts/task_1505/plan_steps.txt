Step 1: Load `payments.csv` and calculate the most frequent values (mode) for `is_credit`, `aci`, and `intracountry` (derived by comparing `issuing_country` and `acquirer_country`) to define the parameters for the "average scenario".
Step 2: Load `merchant_data.json` to retrieve the `account_type`, `merchant_category_code`, and `capture_delay` for the most frequent merchant ("Crossfit_Hanna"), and using `payments.csv`, calculate the average monthly transaction volume and average monthly fraud rate (fraud volume divided by total volume) for this merchant to define the complete set of parameters for the fee lookup.
Step 3: Load `fees.json` and `merchant_data.json`, then using the "average scenario" parameters (Merchant: "Crossfit_Hanna", is_credit: True, aci: "D", intracountry: False, Monthly Volume: ~423,053 EUR, Fraud Rate: ~8.9%), filter the fee rules to find the applicable rule for each card scheme and calculate the transaction fee for 10 EUR to determine the cheapest scheme.
