Step 1: Load the `payments.csv` dataset and filter for transactions where `card_scheme` is 'GlobalCard' and `is_credit` is True.
Step 2: Load `merchant_data.json` and `fees.json`. Calculate the monthly transaction volume and monthly fraud rate for each merchant using the full `payments.csv` dataset. Then, enrich the filtered GlobalCard credit transactions dataframe with these calculated monthly stats (matched by merchant and month), the static merchant details from `merchant_data.json`, and an `intracountry` column (True if `issuing_country` matches `acquirer_country`).
Step 3: Using the enriched GlobalCard credit transactions dataset, iterate through each transaction to identify the applicable fee rule from `fees.json` by matching all criteria (merchant category code, account type, ACI, intracountry status, capture delay, monthly volume, and monthly fraud level, handling wildcards/nulls appropriately), then calculate the fee for a hypothetical 100 EUR transaction (Fee = fixed_amount + rate * 100 / 10000) and compute the overall average fee.
