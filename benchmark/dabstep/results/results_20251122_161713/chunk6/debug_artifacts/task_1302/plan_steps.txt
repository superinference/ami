Step 1: Load the "fees.json" file into a dataframe and display the first 5 rows and the columns and their types to discern how to proceed.
Step 2: Load the "fees.json" file into a dataframe, filter for rows where `card_scheme` is 'NexPay', and display the first 10 rows along with the unique values of the 'is_credit' column in the filtered data.
Step 3: Load the "fees.json" file into a dataframe, filter for rows where `card_scheme` is 'NexPay' and `is_credit` is either True or null, then calculate the fee for a transaction value of 4321 EUR for each rule using the formula `fixed_amount + (rate * 4321 / 10000)`, and finally display the calculated fees along with the columns `merchant_category_code`, `account_type`, `aci`, `intracountry`, `monthly_volume`, and `monthly_fraud_level` to analyze the variation.
Step 4: Load the "fees.json" file into a dataframe, filter the dataframe for rows where the "card_scheme" column is 'NexPay', and display the columns 'is_credit', 'fixed_amount', and 'rate' for these rows to inspect the available fee rules.
Step 5: Load the "payments.csv" file, filter for NexPay credit transactions, merge with "merchant_data.json", calculate derived fields (intracountry, monthly volume, monthly fraud rate), load "fees.json" (filtered for NexPay), and then iterate through each transaction to find the matching fee rule (handling all conditions like MCC, ACI, account type, volume, fraud level, etc.) to calculate the fee for a 4321 EUR amount, finally computing the average of these fees.
