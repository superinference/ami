Step 1: Load the `fees.json` file into a pandas DataFrame, then filter the rows where `card_scheme` is 'TransactPlus' and `is_credit` is either True or null (indicating it applies to credit transactions), in order to identify the relevant fee rules for calculation.
Step 2: Load `payments.csv` and filter for rows where `card_scheme` is 'TransactPlus' and `is_credit` is True. Then, load `merchant_data.json` and merge it with the filtered payments on the `merchant` column. Finally, calculate the `intracountry` status (True if `issuing_country` matches `acquirer_country`), determine the month from `day_of_year`, and compute the `monthly_volume` and `monthly_fraud_rate` for each merchant per month to prepare for fee rule matching.
Step 3: Load the `payments.csv`, `fees.json`, and `merchant_data.json` files, filter for 'TransactPlus' credit transactions, calculate the monthly volume and fraud rates for each merchant to match the fee rules, determine the applicable fee for each transaction context using a hypothetical transaction value of 1234 EUR (formula: `fixed_amount + rate * 1234 / 10000`), and finally compute the average of these fees.
