Step 1: Load the `payments.csv` file into a dataframe and filter for rows where `card_scheme` is 'NexPay' and `is_credit` is True.
Step 2: Load `fees.json` and `merchant_data.json` into dataframes. Filter the `fees` dataframe to include only rows where `card_scheme` is 'NexPay' and `is_credit` is either True or null. Merge the `merchant_data` dataframe into the filtered `payments` dataframe on the 'merchant' column. Finally, create a new column `intracountry` in the `payments` dataframe, setting it to True if `issuing_country` equals `acquirer_country`, and False otherwise.
Step 3: To ensure the calculated average fee is accurate, we need to rigorously match each transaction to the correct fee rule in `fees.json`. This involves not just static merchant attributes but also dynamic ones like monthly volume and fraud levels, which must be derived from the data.

**Plan:**
Calculate the monthly transaction volume and fraud rate for each merchant using the `payments.csv` data. Then, for every NexPay credit transaction, identify the applicable fee rule from `fees.json` by matching all criteria: `merchant_category_code`, `account_type`, `aci`, `intracountry`, `capture_delay`, `monthly_volume`, and `monthly_fraud_level`. Finally, using the `fixed_amount` and `rate` from the matched rules, calculate the fee for a hypothetical 1000 EUR transaction for each record and compute the overall average.
